<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>companion</title>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.js"></script>
    <script src="/static/js/index.js"></script>
</head>
<body>
<!-- 로그인 되었을 때 구분 -->
<div th:if="${session.auth != null}">
    <ul>
        <!-- 회원과 직원 메뉴 분리 로그인 시 grade저장 직원=emp 회원=mem -->
        <th:block th:if="${session.auth.grade == 'emp'}">
            <li><a href="employee/employeeList">직원목록</a></li>
            <li><a href="member/memberList">회원목록</a></li>
            <li><a href="employee/empMyPage">마이페이지</a></li>
            <li><a href="goods/goodsList">상품리스트</a></li>
            <li><a href="/purchase/purchaseList">주문 내역</a></li><!-- 고객이 주문한 내역 확인 -->
            <li><a href="/inquire/goodsQuestion">상품 문의</a></li>
        </th:block>
        <!-- 이메일 임시 비밀번호 전달 후 회원정보 수정에서 비밀번호 변경 절차 -->
        <th:block th:if="${session.auth.grade == 'mem'}">
            <li><a href="/mypage/myDetail">내정보 보기</a></li>
            <li><a href="/corner/wishList">관심 목록</a></li> <!-- 관심상품 목록 보기 -->
            <li><a href="/corner/cartList">장바구니</a></li>
            <li><a href="/purchase/orderList">주문목록</a></li>
        </th:block>

        <!-- 로그아웃 -->
        <li><a href="login/logout">로그아웃</a></li>
    </ul>
</div>

<!-- 로그인이 되지 않았을 때 -->
<div th:if="${session.auth == null}" >
    <form action="/login/login" method="post" th:object="${loginCommand}">
        <table border="1" align="center">
            <tr><td colspan="2">
                자동로그인<input type="checkbox" name="autoLogin" />
                아이디저장<input type="checkbox" name="idStore" />
            </td></tr>
            <tr><td><input type="text" name="userId" placeholder="아이디" th:value="${loginCommand.userId}"/><br/>
                <span th:if="${#fields.hasErrors('userId')}" th:errors="*{userId}"></span></td>
                <td rowspan="2">
                    <input type="image" src="/static/images/logo.png" width="60">
                </td></tr>
            <tr><td><input type="password" name="userPw" placeholder="비밀번호" /><br/>
                <span th:if="${#fields.hasErrors('userPw')}" th:errors="*{userPw}"></span></td></tr>
            <tr><td colspan="2">
                <a href="/register/userWrite">회원가입</a> |
                <a href="/help/findId">아이디</a>/
                <a href="/help/findPassword">비밀번호 찾기</a></td></tr>
        </table>
    </form>
</div>
<!-- 대분류 카테고리 탭 -->
<div id="main-category-tabs">
    <button data-category="all">전체</button>
    <button th:each="category : ${categoryMap.keySet()}" th:data-category="${category}" th:text="${category}"></button>
</div>

<!-- 상품목록 출력과 관심상품 -->
<div id="category-contents">
    <div id="main-category-all" class="main-category-content">
        <div id="category-all-all" class="category-content">
            <div>전체 상품</div>
            <table align="center" width="600">
                <tr>
                    <th:block th:each="category : ${categoryMap.keySet()}">
                        <th:block th:each="dto, idx : ${categoryMap.get(category)}">
                            <td>
                                <a th:href="|corner/detailView/${dto.goodsNum}|">
                                    <img th:src="@{|/static/upload/${dto.goodsMainStore}|}" /><br />
                                    [[${dto.goodsName}]]<br/>
                                    [[${dto.goodsPrice}]]<br/>
                                    <span th:if="${dto.deliveryCost == 0}">무료배송</span>
                                    <span th:if="${dto.deliveryCost != 0}" th:text="${dto.deliveryCost}"></span>
                                </a>
                            </td>
                            <th:block th:if="${idx.count % 3 == 0}" th:utext="'</tr><tr>'"/>
                        </th:block>
                    </th:block>
                </tr>
            </table>
        </div>
    </div>
    <!-- 각 카테고리별 상품 목록 -->
    <div th:each="category : ${categoryMap.keySet()}" th:id="'category-' + ${category}" class="category-content">
        <div th:text="${category}"></div>
        <table align="center" width="600">
            <tr>
                <th:block th:each="dto, idx : ${categoryMap.get(category)}">
                    <td>
                        <a th:href="|corner/detailView/${dto.goodsNum}|">
                            <img th:src="@{|/static/upload/${dto.goodsMainStore}|}" /><br />
                            [[${dto.goodsName}]]<br/>
                            [[${dto.goodsPrice}]]<br/>
                            <span th:if="${dto.deliveryCost == 0}">무료배송</span>
                            <span th:if="${dto.deliveryCost != 0}" th:text="${dto.deliveryCost}"></span>
                        </a>
                    </td>
                    <th:block th:if="${idx.count % 3 == 0}" th:utext="'</tr><tr>'"/>
                </th:block>
            </tr>
        </table>
    </div>
</div>
</body>
</html>