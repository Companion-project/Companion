
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>companion</title>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.js"></script>
<script src="/static/js/index.js"></script>
    <script th:inline="javascript">
    var categoryMap = /*[[${categoryMap}]]*/ {};
</script>
</head>
<body>
<!-- 로그인 되었을 때 구분 -->
<div th:if="${session.auth != null}">
    <!--   // UserLoginService 아이디와 비번이 일치하면 session에 로그인 정보 저장 session.setAttribute("auth", dto);-->
<ul>
    <!-- 회원과 직원 메뉴 분리 로그인 시 grade저장 직원=emp 회원=mem -->
    <th:block th:if="${session.auth.grade == 'emp'}">
    <li><a href="employee/employeeList">직원목록</a></li>
    <li><a href="member/memberList">회원목록</a></li>
    <li><a href="employee/empMyPage">마이페이지</a></li>
    <li><a href="goods/goodsList">상품리스트</a></li>
    </th:block>
    <!-- 이메일 임시 비밀번호 전달 후 회원정보 수정에서 비밀번호 변경 절차 -->
    <th:block th:if="${session.auth.grade == 'mem'}">
        <li><a href="/mypage/myDetail">내정보 보기</a></li>
    </th:block>

    <!-- 로그아웃 -->
    <li><a href="login/logout">로그아웃</a></li>
</ul>
</div>
<!-- 직원과 회원이 같은 페이지에서 로그인 -->
<!-- 오류가 있는경우 th:object 값 가져오기/ UserLoginService에서 result.rejectValue 받아오기-->

<!-- 로그인이 되지 않았을 떄 -->
<div th:if="${session.auth == null}" >
<form action="/login/login" method="post" th:object="${loginCommand}">
    <table border="1" align="center">
        <tr><td colspan="2">
            자동로그인<input type="checkbox" name="autoLogin" />
            아이디저장<input type="checkbox" name="idStore" />
        </td></tr>
        <tr><td><input type="text" name="userId" placeholder="아이디" th:value="${loginCommand.userId}"/><br/>
                <span th:if="${#fields.hasErrors('userId')}" th:errors="*{userId}"></span></td>
            <td rowspan="2">
                <input type="image" src="/static/images/compa.png" width="60">
            </td></tr>
        <tr><td><input type="password" name="userPw" placeholder="비밀번호" /><br/>
                <span th:if="${#fields.hasErrors('userPw')}" th:errors="*{userPw}"></span></td></tr>
        <tr><td colspan="2">
            <a href="/register/userWrite">회원가입</a> |
            <a href="/help/findId">아이디</a>/
            <a href="/help/findPassword">비밀번호 찾기</a></td></tr>
    </table>
</form>
</div>
<!-- 대분류 카테고리 탭 -->
<div id="main-category-tabs">
    <button data-category="사료">사료</button>
    <button data-category="간식">간식</button>
    <button data-category="용품">용품</button>
</div>

<!-- 소분류 카테고리 탭 -->
<div id="sub-category-tabs"></div>

<!-- 상품목록 출력과 관심상품 -->
<div id="category-contents">
    <div th:each="mainCategory : ${categoryMap.keySet()}" th:id="'main-category-' + ${mainCategory}" class="main-category-content">
        <div th:each="subCategory : ${categoryMap.get(mainCategory).keySet()}" th:id="'sub-category-' + ${mainCategory} + '-' + ${subCategory}" class="sub-category-content" style="display: none;">
            <div th:text="${subCategory}"></div>
            <table align="center" width="600">
                <tr>
                    <th:block th:each="dto, idx : ${categoryMap.get(mainCategory).get(subCategory)}">
                        <td>
                            <a th:href="@{|/goods/goodsDetail?goodsNum=${dto.goodsNum}|}">
                                <img th:src="@{|/static/upload/${dto.goodsMainStore}|}" /><br />
                                [[${dto.goodsName}]]<br/>
                                [[${dto.goodsPrice}]]<br/>
                                <span th:if="${dto.deliveryCost == 0}">무료배송</span>
                                <span th:if="${dto.deliveryCost != 0}" th:text="${dto.deliveryCost}"></span>
                            </a>
                        </td>
                        <th:block th:if="${idx.count % 3 == 0}" th:utext="'</tr><tr>'"/>
                    </th:block>
                </tr>
            </table>
        </div>
    </div>
</div>
</body>
</html>
